webpackJsonp([1],{"+g0x":function(t,e,n){"use strict";function a(t){n("RGKg")}var s=n("chHD"),o=n("Uqej"),i=n("VU/8"),r=a,c=i(s.a,o.a,!1,r,"data-v-15c37d66",null);e.a=c.exports},"3GDu":function(t,e,n){"use strict";function a(t){n("sVbO")}var s=n("Gxhs"),o=n("n82r"),i=n("VU/8"),r=a,c=i(s.a,o.a,!1,r,"data-v-5c488874",null);e.a=c.exports},"7wC2":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"header"},[n("v-layout",[n("v-card",[n("v-card-title",{attrs:{"primary-title":""}},[n("div",[n("h3",{staticClass:"headline mb-0"},[t._v("Airbnb Guesty Heatmap")]),t._v(" "),n("div",[t._v("Brooklyn is prefetched "),n("br"),t._v("Try other small locations for a small demo (Netivot for example) ...")])])])],1)],1)],1)},s=[],o={render:a,staticRenderFns:s};e.a=o},FX9o:function(t,e){},Gxhs:function(t,e,n){"use strict";e.a={name:"heatmap",props:[],mounted:function(){var t=this,e=document.getElementById("google-maps"),n=function n(){e.setAttribute("loaded",!0),t.onScriptReady(),e.removeEventListener("load",n)};e?e.getAttribute("load")?this.onScriptReady():e.addEventListener("load",n):(e=document.createElement("script"),e.setAttribute("type","text/javascript"),e.setAttribute("async",!0),e.setAttribute("defer",!0),e.id="google-maps",e.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD1ECSGppdpqz0-T0GxqJWc4_SObmZ7HdQ&libraries=visualization",e.addEventListener("load",n),document.body.appendChild(e))},data:function(){return{scriptLoaded:!1}},methods:{onScriptReady:function(){this.scriptLoaded=!0,this.points&&this.drawMap(this.points)},drawMap:function(){var t=this.points;if(this.scriptLoaded&&t&&t.length){var e=t.map(function(t){return t.lng}).reduce(function(t,e){return t+e})/t.length,n=t.map(function(t){return t.lat}).reduce(function(t,e){return t+e})/t.length,a=new window.google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:n,lng:e},mapTypeId:"satellite"}),s=t.map(function(t){return{location:new window.google.maps.LatLng(t.lat,t.lng),weight:t.weight}});new window.google.maps.visualization.HeatmapLayer({data:s,map:a})}}},watch:{points:function(t){this.drawMap(t)}},computed:{points:function(){return this.$store.state.heatmapPoints},shouldShowMap:function(){return this.points&&this.points.length&&this.scriptLoaded}}}},HCTz:function(t,e,n){"use strict";e.a={name:"app-header",props:[],mounted:function(){},data:function(){return{}},methods:{},computed:{}}},IcnI:function(t,e,n){"use strict";var a=n("Xxa5"),s=n.n(a),o=n("exGp"),i=n.n(o),r=n("NYxO"),c=n("7+uW"),u=this;c.a.use(r.a),e.a=new r.a.Store({state:{location:"brooklyn",status:{done:!1,searchDone:!1,currentPrice:0,demand:0,listingsCount:0,demandDone:0},heatmapPoints:[],requestId:"",polling:!1},mutations:{set_points:function(t,e){t.heatmapPoints=e},set_polling:function(t,e){t.polling=e},set_status:function(t,e){t.status=e},set_location:function(t,e){t.location=e},set_request_id:function(t,e){t.requestId=e}},actions:{cancelSearch:function(t){var e=t.commit;e("set_polling",!1),e("set_request_id",null)},getPoints:function(){var t=i()(s.a.mark(function t(e){var n,a=e.state,o=e.commit,i=e.dispatch;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i("cancelSearch"),o("set_points",[]),t.next=4,fetch("/api/heatmap/"+a.location);case 4:return t.next=6,t.sent.json();case 6:n=t.sent,n.points?(o("set_points",n.points),o("set_polling",!1)):(o("set_request_id",n.requestId),o("set_status",{done:!1,searchDone:!1,currentPrice:0,demand:0,listingsCount:0,demandDone:0}),i("poll",n.requestId));case 8:case"end":return t.stop()}},t,u)}));return function(e){return t.apply(this,arguments)}}(),poll:function(){var t=i()(s.a.mark(function t(e,n){var a,o=e.state,i=e.commit,r=e.dispatch;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o.requestId===n&&o.requestId&&n){t.next=2;break}return t.abrupt("return");case 2:return i("set_polling",!0),t.next=5,fetch("/api/status/"+o.requestId);case 5:return t.next=7,t.sent.json();case 7:a=t.sent,i("set_status",a),a.done?(i("set_polling",!1),r("getPoints")):setTimeout(function(){return r("poll",n)},1e3);case 10:case"end":return t.stop()}},t,u)}));return function(e,n){return t.apply(this,arguments)}}()}})},M93x:function(t,e,n){"use strict";function a(t){n("FX9o")}var s=n("xJD8"),o=n("MTSB"),i=n("VU/8"),r=a,c=i(s.a,o.a,!1,r,null,null);e.a=c.exports},MTSB:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("v-app",[n("app-header"),t._v(" "),n("location"),t._v(" "),n("status"),t._v(" "),n("heat-map")],1)],1)},s=[],o={render:a,staticRenderFns:s};e.a=o},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("7+uW"),s=n("3EgV"),o=n.n(s),i=n("M93x"),r=n("IcnI");a.a.use(o.a),a.a.config.productionTip=!1,new a.a({el:"#app",store:r.a,template:"<App/>",components:{App:i.a}})},R9bc:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.polling?n("section",{staticClass:"status"},[t.status.done?n("div",{staticClass:"done"},[t._v("Done generating heatmap")]):n("div",[t.status.searchDone?n("div",[t._v("\n      Finished searching, got "+t._s(t.status.listingsCount)+" total listings, calculating demand, "+t._s(t.demandPercent)+"% done\n    ")]):n("div",[t._v("Searching, got "+t._s(t.status.listingsCount)+" so far")])])]):t._e()},s=[],o={render:a,staticRenderFns:s};e.a=o},RGKg:function(t,e){},TNlu:function(t,e,n){"use strict";function a(t){n("y+Kf")}var s=n("m5wU"),o=n("R9bc"),i=n("VU/8"),r=a,c=i(s.a,o.a,!1,r,"data-v-36666b0a",null);e.a=c.exports},Twed:function(t,e){},Uqej:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"location"},[n("v-text-field",{attrs:{disabled:t.polling,label:"Enter location",type:"text"},model:{value:t.location,callback:function(e){t.location=e},expression:"location"}}),t._v(" "),n("v-btn",{attrs:{disabled:t.polling||t.location.length<2,color:"red"},on:{click:function(e){t.searchLocation()}}},[t._v("Search")]),t._v(" "),n("v-btn",{attrs:{disabled:!t.polling,color:"black"},on:{click:function(e){t.cancel()}}},[t._v("Cancel")])],1)},s=[],o={render:a,staticRenderFns:s};e.a=o},chHD:function(t,e,n){"use strict";e.a={name:"location",props:[],components:{},mounted:function(){},data:function(){return{}},methods:{searchLocation:function(){this.$store.dispatch("getPoints")}},computed:{polling:function(){this.$store.dispatch("cancelSearch")},location:{get:function(){return this.$store.state.location},set:function(t){this.$store.commit("set_location",t)}}}}},m5wU:function(t,e,n){"use strict";e.a={name:"status",props:[],mounted:function(){},data:function(){return{}},methods:{},computed:{status:function(){return this.$store.state.status},polling:function(){return this.$store.state.polling},demandPercent:function(){var t=this.status;return 0===t.demand?0:Number(t.demandDone/t.demand).toFixed(2)}}}},n82r:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement;return(t._self._c||e)("section",{directives:[{name:"show",rawName:"v-show",value:t.shouldShowMap,expression:"shouldShowMap"}],staticClass:"map",attrs:{id:"map"}})},s=[],o={render:a,staticRenderFns:s};e.a=o},sVbO:function(t,e){},teIl:function(t,e,n){"use strict";function a(t){n("Twed")}var s=n("HCTz"),o=n("7wC2"),i=n("VU/8"),r=a,c=i(s.a,o.a,!1,r,"data-v-c5068fb6",null);e.a=c.exports},xJD8:function(t,e,n){"use strict";var a=n("+g0x"),s=n("3GDu"),o=n("TNlu"),i=n("teIl");e.a={name:"app",components:{Location:a.a,HeatMap:s.a,Status:o.a,AppHeader:i.a}}},"y+Kf":function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.7e9496a2e214ccc5500c.js.map